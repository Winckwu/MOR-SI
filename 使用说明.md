# 国家能力合同分类器 - 使用说明

基于 Berwick & Christia (2018) "State Capacity Redux" 论文框架

## 模型性能对比

| 指标 | 方案1（关键词规则） | 方案2（LLM语义规则） |
|------|---------------------|---------------------|
| 准确率 | 94.95% | **98.35%** |
| F1分数 | 93.54% | **98.32%** |
| 推荐 | - | ✓ 推荐使用 |

## 快速开始

### 1. 对你的数据进行分类

```bash
# 使用推荐的方案2模型（默认）
python predict.py --data 你的数据.xlsx --column 合同名称

# 或者使用方案1模型
python predict.py --data 你的数据.xlsx --column 合同名称 --model model_rule_based.pkl
```

### 2. 在Python代码中使用

```python
from predict import ContractClassifier

# 加载模型（默认使用方案2）
classifier = ContractClassifier()

# 预测单个合同
result = classifier.predict("某某学校教学设备采购项目")
print(result[0]["predicted_label"])  # 输出: 合规能力

# 预测DataFrame
import pandas as pd
df = pd.read_excel("你的数据.xlsx")
result_df = classifier.predict_dataframe(df, text_column="合同名称")
result_df.to_excel("分类结果.xlsx", index=False)
```

## 三种国家能力分类

| 类型 | 英文 | 定义 | 典型关键词 |
|------|------|------|------------|
| **汲取能力** | Extractive | 国家从社会获取资源的能力 | 税务、财政、审计、土地调查、统计普查 |
| **协调能力** | Coordination | 国家组织集体行动的能力 | 建设工程、交通设施、信息化、办公采购 |
| **合规能力** | Compliance | 确保公民服从国家目标的能力 | 教育、医疗、执法、社保、监督培训 |

## 文件说明

| 文件 | 说明 |
|------|------|
| `predict.py` | **主要使用的预测脚本** |
| `model_llm_semantic.pkl` | 方案2模型（推荐，F1=98.32%）|
| `model_rule_based.pkl` | 方案1模型（F1=93.54%）|
| `enhanced_classifier.py` | 增强版分类器（关键词词典）|
| `train_and_compare.py` | 模型训练脚本 |

## 重新训练模型

如果你有新的训练数据：

```bash
python train_and_compare.py
```

这会重新训练两个方案的模型并保存。

## 预测结果说明

输出的Excel文件包含以下新列：

| 列名 | 说明 |
|------|------|
| 预测类别 | 汲取能力/协调能力/合规能力 |
| 预测置信度 | 模型对预测结果的信心（0-1） |
| 汲取能力概率 | 属于汲取能力的概率 |
| 协调能力概率 | 属于协调能力的概率 |
| 合规能力概率 | 属于合规能力的概率 |
