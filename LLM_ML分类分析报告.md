# 国家能力合同分类 - LLM标注+ML模型 分析报告

**基于 Berwick & Christia (2018) "State Capacity Redux" 论文框架**

---

## 第一部分：方法论概述

### 1.1 研究框架

本分类器基于Berwick & Christia (2018)提出的国家能力三维框架：

| 能力类型 | 英文名称 | 核心定义 | 理论来源 |
|----------|----------|----------|----------|
| 汲取能力 | Extractive Capacity | 国家从社会获取资源的能力 | Tilly (1990), Levi (1988) |
| 协调能力 | Coordination Capacity | 国家组织集体行动、提供公共品的能力 | Mann (1984), Weber (1946) |
| 合规能力 | Compliance Capacity | 确保公民和官僚服从国家目标的能力 | Olken (2007), Holland (2015) |

### 1.2 技术方案

采用**LLM语义标注 + ML模型**的两阶段方案：

```
阶段1: LLM语义标注
  ├─ 多层次语义规则
  │   ├─ 机构识别层（识别采购单位性质）
  │   ├─ 核心概念层（匹配理论框架核心概念）
  │   ├─ 活动类型层（识别具体业务活动）
  │   └─ 上下文推理层（综合多信号推理）
  └─ 输出: 标签 + 置信度

阶段2: ML模型训练
  ├─ 筛选高置信度样本（≥60%）
  ├─ TF-IDF特征提取
  ├─ SVM/LR/RF模型训练
  └─ 输出: 可复用的分类模型
```

---

## 第二部分：数据概况

### 2.1 原始数据

| 项目 | 数值 |
|------|------|
| 数据来源 | 2015年政府采购合同 |
| 总记录数 | 19,666 条 |
| 文本字段 | 合同名称 |

### 2.2 合同名称统计

| 指标 | 数值 |
|------|------|
| 有效记录 | 19,666 条 |
| 平均长度 | 20.6 字符 |
| 最短长度 | 2 字符 |
| 最长长度 | 137 字符 |

---

## 第三部分：LLM语义标注结果

### 3.1 标注分布

| 能力类型 | 数量 | 占比 |
|----------|------|------|
| 汲取能力 | 3,082 | 15.7% |
| 协调能力 | 10,837 | 55.1% |
| 合规能力 | 5,747 | 29.2% |

### 3.2 置信度分析

#### 总体置信度

| 指标 | 数值 |
|------|------|
| 平均置信度 | 0.752 |
| 中位数置信度 | 0.930 |
| 标准差 | 0.290 |
| 高置信度样本(≥0.6) | 13,440 (68.3%) |

#### 各类别置信度

| 能力类型 | 平均置信度 | 中位数 | 高置信度(≥0.8)占比 |
|----------|------------|--------|-------------------|
| 汲取能力 | 0.858 | 0.847 | 73.8% |
| 协调能力 | 0.651 | 0.444 | 45.9% |
| 合规能力 | 0.886 | 1.000 | 72.5% |

---

## 第四部分：ML模型训练结果

### 4.1 训练数据

| 项目 | 数值 |
|------|------|
| 高置信度训练样本 | 13,440 条 |
| 训练集占比 | 80% |
| 测试集占比 | 20% |
| 置信度阈值 | ≥0.6 |

### 4.2 模型对比

| 模型 | 准确率 | F1分数 |
|------|--------|--------|
| SVM | 0.9885 | 0.9892 |
| Logistic Regression | 0.9795 | 0.9795 |
| Random Forest | 0.9754 | 0.9759 |

**最佳模型: SVM**

### 4.3 最佳模型详细评估

#### 混淆矩阵

| 真实\预测 | 汲取能力 | 协调能力 | 合规能力 |
|-----------|----------|----------|----------|
| 汲取能力 | 576 | 5 | 0 |
| 协调能力 | 2 | 1054 | 12 |
| 合规能力 | 1 | 11 | 1027 |

#### 性能指标

| 指标 | 数值 |
|------|------|
| 准确率 (Accuracy) | 0.9885 |
| 宏平均F1 (Macro F1) | 0.9892 |

---

## 第五部分：全量预测结果

### 5.1 预测分布

| 能力类型 | 数量 | 占比 |
|----------|------|------|
| 汲取能力 | 3,109 | 15.8% |
| 协调能力 | 9,569 | 48.7% |
| 合规能力 | 6,988 | 35.5% |

### 5.2 典型样本

#### 汲取能力样本

- 甘肃省清水县2014年中央财政现代农业生产发展项目全钢架无立柱塑料大棚建设项目...
- 皋兰县财政局村级一事一议村容村貌改造亮化采购项目购销合同...
- 皋兰县财政局村级一事一议村容村貌改造亮化采购项目购销合同...

#### 协调能力
- 文县文体局非物质文化遗产保护中心家电采购项目...
- 采购合同...
- 政府采购合同...

#### 合规能力
- 渭源县2014年度土地变更调查与遥感监测工作服务项目...
- 庆阳市西峰区陇东职业中等专业学校国家示范校建设人才培养就业竞争力提升项目...
- 庆阳市西峰区陇东职业中等专业学校国家示范校建设人才培养就业竞争力提升项目...

#### 

---

## 第六部分：LLM语义规则详解

### 6.1 汲取能力关键词

| 类别 | 关键词 | 理论来源 |
|------|--------|----------|
| 核心概念 | 税、税收、财政、预算、审计 | Tilly (1990), Levi (1988) |
| 机构特征 | 税务局、财政局、海关、统计局 | D'Arcy & Nistotskaya (2016) |
| 活动特征 | 土地调查、确权、登记、普查 | Brambor et al. (2016) |

### 6.2 协调能力关键词

| 类别 | 关键词 | 理论来源 |
|------|--------|----------|
| 核心概念 | 建设、工程、规划、网络、信息化 | Mann (1984, 2008) |
| 机构特征 | 建设局、交通局、水利局、电力 | Weber (1946), Evans (1989) |
| 活动特征 | 公路、桥梁、供水、供电、办公 | Herbst (2000) |

### 6.3 合规能力关键词

| 类别 | 关键词 | 理论来源 |
|------|--------|----------|
| 核心概念 | 教育、医疗、监督、执法、培训 | Olken (2007) |
| 机构特征 | 学校、医院、公安局、法院 | Muralidharan (2011) |
| 活动特征 | 教学设备、医疗设备、执法装备 | Holland (2015) |

---

## 第七部分：模型使用说明

### 7.1 输出文件

| 文件 | 说明 |
|------|------|
| `llm_ml_model.pkl` | 训练好的ML模型（可直接加载使用） |
| `LLM_ML分类结果.xlsx` | 全量数据分类结果 |
| `LLM_ML分类分析报告.md` | 本分析报告 |
| `llm_ml_classifier.py` | 分类器源代码 |

### 7.2 新数据预测代码

```python
from llm_ml_classifier import LLMMLClassifier, simple_tokenizer
import pandas as pd

# 加载模型
classifier = LLMMLClassifier.load_model("llm_ml_model.pkl")

# 读取新数据
new_df = pd.read_excel("新数据.xlsx")

# 预测
texts = new_df["合同名称"].astype(str).tolist()
results = classifier.predict(texts)

# 添加预测结果
new_df["预测类别"] = [r["predicted_label"] for r in results]

# 保存结果
new_df.to_excel("预测结果.xlsx", index=False)
```

### 7.3 命令行使用

```bash
# 训练新模型
python llm_ml_classifier.py --train --data 数据.xlsx

# 预测新数据
python llm_ml_classifier.py --predict --data 新数据.xlsx --model llm_ml_model.pkl
```

---

## 第八部分：方法局限与改进方向

### 8.1 当前局限

1. **语义理解深度有限**: 模拟LLM的规则无法达到真实LLM的语义理解能力
2. **多标签问题**: 部分合同可能同时涉及多种能力，当前采用单标签分类
3. **上下文信息未充分利用**: 未使用采购单位、金额等元数据

### 8.2 改进方向

1. 接入真实LLM API（OpenAI/Claude）进行标注
2. 引入BERT等预训练语言模型
3. 采用多标签分类框架
4. 结合元数据构建多模态分类器

---

**报告生成时间**: 2025-11-28 14:12:17
